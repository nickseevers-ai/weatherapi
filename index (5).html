<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASOS LIVE — Settlement Monitor</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&display=swap');

:root {
  --bg:        #080a0d;
  --card:      #0e1117;
  --card-hi:   #141820;
  --border:    #1c2330;
  --border-hi: #2a3444;
  --txt:       #b8c4d4;
  --txt-dim:   #5a6577;
  --txt-hi:    #dce4ee;
  --green:     #3fb950;
  --green-bg:  #0d2818;
  --red:       #f85149;
  --red-bg:    #2d1015;
  --amber:     #d29922;
  --amber-bg:  #2d2310;
  --cyan:      #58a6ff;
  --cyan-bg:   #0c1e36;
  --purple:    #bc8cff;
  --tab-active:#58a6ff;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  background: var(--bg);
  color: var(--txt);
  font-family: 'IBM Plex Mono', 'Courier New', monospace;
  font-size: 12px;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* ── TOP BAR ──────────────────────────────────────── */
.topbar {
  background: var(--card);
  border-bottom: 1px solid var(--border);
  padding: 8px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
}
.topbar-left { display: flex; align-items: center; gap: 12px; }
.logo { font-weight: 600; font-size: 14px; color: var(--txt-hi); letter-spacing: 3px; }
.logo em { color: var(--cyan); font-style: normal; }
.heartbeat {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--green); box-shadow: 0 0 5px var(--green);
  animation: hb 2s ease-in-out infinite;
}
@keyframes hb { 0%,100%{opacity:1} 50%{opacity:.3} }
.topbar-right { display: flex; align-items: center; gap: 20px; font-size: 11px; color: var(--txt-dim); }
.topbar-right .clock { color: var(--txt); font-weight: 500; font-size: 12px; }

/* ── TAB BAR ──────────────────────────────────────── */
.tabbar {
  display: flex;
  gap: 2px;
  padding: 8px 16px 0;
  max-width: 1520px;
  margin: 0 auto;
  border-bottom: 1px solid var(--border);
}
.tab {
  padding: 6px 14px;
  font-size: 11px;
  font-weight: 500;
  color: var(--txt-dim);
  cursor: pointer;
  border: none;
  background: none;
  font-family: inherit;
  letter-spacing: .5px;
  border-bottom: 2px solid transparent;
  transition: color .2s, border-color .2s;
}
.tab:hover { color: var(--txt); }
.tab.active { color: var(--cyan); border-bottom-color: var(--cyan); }

/* ── PANEL VISIBILITY ─────────────────────────────── */
.panel { display: none; }
.panel.active { display: block; }

/* ── GRID ──────────────────────────────────────────── */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(272px, 1fr));
  gap: 8px;
  padding: 12px 16px;
  max-width: 1520px;
  margin: 0 auto;
}

/* ── CARD ──────────────────────────────────────────── */
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 5px;
  overflow: hidden;
  transition: border-color .25s;
}
.card:hover { border-color: var(--border-hi); }
.card.ks-shift  { border-color: var(--amber); }
.card.ks-regime { border-color: var(--red); }

.ks-banner {
  font-size: 10px; font-weight: 600; letter-spacing: .6px;
  text-transform: uppercase; padding: 3px 12px; display: none;
}
.ks-banner.shift  { display:block; background: var(--amber-bg); color: var(--amber); }
.ks-banner.regime { display:block; background: var(--red-bg);   color: var(--red); }

.card-hdr { display: flex; align-items: center; justify-content: space-between; padding: 9px 12px 4px; }
.card-hdr-l { display:flex; align-items:center; gap:8px; }
.sid { font-weight:600; font-size:13px; color:var(--txt-hi); letter-spacing:.8px; }
.city { font-size:10px; color:var(--txt-dim); }
.obs-time { font-size:10px; color:var(--txt-dim); }
.card-body { padding: 2px 12px 10px; }

.temp-row { display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 8px; }
.temp-big { font-size: 34px; font-weight: 300; color: var(--txt-hi); letter-spacing: -1px; line-height: 1.1; }
.temp-big .u { font-size:15px; color:var(--txt-dim); font-weight:400; margin-left:1px; }

.tg-badge {
  font-size: 11px; font-weight: 500; color: var(--cyan);
  background: var(--cyan-bg); padding: 2px 7px; border-radius: 3px; white-space: nowrap;
}
.tg-badge.stale { color:var(--txt-dim); background:var(--card-hi); }
.tg-badge .lbl { font-size:9px; font-weight:400; opacity:.6; margin-right:2px; }

.stats { display: grid; grid-template-columns: 1fr 1fr; gap: 5px 14px; }
.stat { display:flex; flex-direction:column; }
.stat-l { font-size:9px; color:var(--txt-dim); text-transform:uppercase; letter-spacing:.7px; margin-bottom:1px; }
.stat-v { font-size:12px; color:var(--txt); font-weight:500; }
.wind-arrow { display:inline-block; font-size:13px; margin-right:3px; transition: transform .35s ease; }
.divider { border-top:1px solid var(--border); margin: 7px 0; }

.dhi-row { display:flex; justify-content:space-between; align-items:center; }
.dhi-row .dhi-l { font-size:9px; color:var(--txt-dim); text-transform:uppercase; letter-spacing:.7px; }
.dhi-row .dhi-v { font-size:13px; font-weight:600; color:var(--green); }
.dhi-row .dhi-t { font-size:10px; color:var(--txt-dim); margin-left:6px; }

.upstream-row {
  margin-top:5px; padding: 4px 7px; background: var(--card-hi);
  border-radius: 3px; display:flex; justify-content:space-between; align-items:center; font-size:11px;
}
.upstream-row .up-l { color:var(--txt-dim); font-size:9px; text-transform:uppercase; letter-spacing:.6px; }
.upstream-row .up-v { color:var(--purple); font-weight:500; }

/* ── SCAN TABLE ────────────────────────────────────── */
.scan-wrap { padding: 12px 16px; max-width: 1520px; margin: 0 auto; overflow-x: auto; }
.scan-tbl {
  width: 100%; border-collapse: collapse; font-size: 12px;
  border: 1px solid var(--border); border-radius: 5px; overflow: hidden;
}
.scan-tbl th {
  background: var(--card-hi); color: var(--txt-dim); font-weight: 500;
  text-transform: uppercase; letter-spacing: .6px; font-size: 10px;
  padding: 8px 12px; text-align: right; border-bottom: 1px solid var(--border);
}
.scan-tbl th:first-child { text-align: left; }
.scan-tbl td {
  padding: 7px 12px; border-bottom: 1px solid var(--border);
  color: var(--txt); text-align: right; background: var(--card);
}
.scan-tbl td:first-child { text-align: left; font-weight: 500; color: var(--txt-hi); }
.scan-tbl tr:last-child td { border-bottom: none; }
.scan-tbl .mean { color: var(--cyan); font-weight: 600; }
.scan-status { padding: 12px 16px; max-width: 1520px; margin: 0 auto; font-size: 11px; color: var(--txt-dim); }
.scan-status .cached { color: var(--amber); }
.scan-status .fresh  { color: var(--green); }
.scan-btn {
  background: var(--cyan-bg); color: var(--cyan); border: 1px solid var(--cyan);
  border-radius: 3px; padding: 4px 10px; font-size: 11px; font-family: inherit;
  cursor: pointer; margin-left: 10px;
}
.scan-btn:hover { background: var(--cyan); color: var(--bg); }

/* ── AFD PANELS ────────────────────────────────────── */
.afd-wrap { padding: 12px 16px; max-width: 1520px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 8px; }
.afd-card { background: var(--card); border: 1px solid var(--border); border-radius: 5px; overflow: hidden; }
.afd-hdr {
  background: var(--card-hi); padding: 6px 10px; display: flex;
  justify-content: space-between; align-items: center; cursor: pointer;
  border-bottom: 1px solid var(--border);
}
.afd-hdr .afd-sid { font-weight: 600; color: var(--txt-hi); font-size: 12px; }
.afd-hdr .afd-wfo { font-size: 10px; color: var(--txt-dim); }
.afd-body { padding: 10px; font-size: 11px; color: var(--txt); line-height: 1.55; white-space: pre-wrap; max-height: 0; overflow: hidden; transition: max-height .3s ease; }
.afd-card.open .afd-body { max-height: 600px; }
.afd-card .afd-err { color: var(--red); font-size: 10px; padding: 6px 10px; }

/* ── KALSHI TABLE ──────────────────────────────────── */
.kalshi-wrap { padding: 12px 16px; max-width: 1520px; margin: 0 auto; }
.kalshi-city { margin-bottom: 14px; }
.kalshi-city-hdr { font-size: 12px; font-weight: 600; color: var(--txt-hi); padding: 6px 0; border-bottom: 1px solid var(--border); margin-bottom: 4px; }
.kalshi-city-hdr .kt { font-size: 10px; color: var(--txt-dim); font-weight: 400; margin-left: 8px; }
.kt-row { display: flex; justify-content: space-between; padding: 3px 0; font-size: 11px; border-bottom: 1px solid var(--border); }
.kt-row:last-child { border-bottom: none; }
.kt-row .kt-title { color: var(--txt); }
.kt-row .kt-prices { display: flex; gap: 18px; }
.kt-row .kt-ask { color: var(--red); font-weight: 600; }
.kt-row .kt-bid { color: var(--green); font-weight: 600; }
.kt-row .kt-lbl { color: var(--txt-dim); font-size: 9px; }
.kt-none { color: var(--txt-dim); font-size: 11px; font-style: italic; padding: 4px 0; }

/* ── LOADING ── */
.loader {
  position:fixed; inset:0; background:var(--bg);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:14px; z-index:999;
}
.loader .logo { font-size:20px; }
.spin { width:28px; height:28px; border:2px solid var(--border); border-top-color:var(--cyan); border-radius:50%; animation:spin .6s linear infinite; }
@keyframes spin { to{transform:rotate(360deg)} }
.loader p { color:var(--txt-dim); font-size:11px; }

/* ── FOOTER ── */
.footer { text-align:center; padding:14px; font-size:10px; color:var(--txt-dim); border-top:1px solid var(--border); margin-top:4px; }
.footer a { color:var(--cyan); text-decoration:none; }
</style>
</head>
<body>

<div class="loader" id="loader">
  <div class="logo">ASOS<em>LIVE</em></div>
  <div class="spin"></div>
  <p id="loader-msg">Connecting to settlement airports…</p>
</div>

<div class="topbar">
  <div class="topbar-left">
    <div class="logo">ASOS<em>LIVE</em></div>
    <div class="heartbeat" id="hb"></div>
  </div>
  <div class="topbar-right">
    <span class="sync">Sync: <span id="syncT">—</span></span>
    <span class="clock" id="clock"></span>
  </div>
</div>

<!-- TAB BAR -->
<div class="tabbar">
  <button class="tab active" data-tab="live">Live METAR</button>
  <button class="tab"        data-tab="scan">Model Scan</button>
  <button class="tab"        data-tab="afd">AFD</button>
  <button class="tab"        data-tab="kalshi">Kalshi</button>
</div>

<!-- PANELS -->
<div class="panel active" id="panel-live">
  <div class="grid" id="grid"></div>
</div>

<div class="panel" id="panel-scan">
  <div class="scan-status" id="scan-status">
    <span id="scan-freshness">Not loaded</span>
    <button class="scan-btn" id="scan-refresh-btn">↻ Refresh</button>
  </div>
  <div class="scan-wrap">
    <table class="scan-tbl" id="scan-tbl">
      <thead><tr>
        <th>City</th><th>NWS</th><th>ECMWF</th><th>GFS</th><th>Mean</th>
      </tr></thead>
      <tbody id="scan-body"></tbody>
    </table>
  </div>
</div>

<div class="panel" id="panel-afd">
  <div class="scan-status">
    <span id="afd-freshness">Not loaded</span>
    <button class="scan-btn" id="afd-refresh-btn">↻ Refresh</button>
  </div>
  <div class="afd-wrap" id="afd-grid"></div>
</div>

<div class="panel" id="panel-kalshi">
  <div class="scan-status">
    <span id="kalshi-freshness">Not loaded</span>
    <button class="scan-btn" id="kalshi-refresh-btn">↻ Refresh</button>
  </div>
  <div class="kalshi-wrap" id="kalshi-grid"></div>
</div>

<div class="footer">
  Source: <a href="https://api.weather.gov" target="_blank">api.weather.gov</a> &nbsp;·&nbsp;
  <a href="https://api.open-meteo.com" target="_blank">open-meteo</a> &nbsp;·&nbsp;
  <a href="https://api.elections.kalshi.com" target="_blank">kalshi</a> &nbsp;·&nbsp;
  5-min AUTO obs + T-group precision &nbsp;·&nbsp; Kill-switch: KILG→PHL, KPAE→SEA
</div>

<script>
// ─── STATE ───────────────────────────────────────────
let cardOrder = [];  // populated from first snapshot

// ─── CLOCK ───────────────────────────────────────────
(function tickClock(){
  document.getElementById("clock").textContent =
    new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:true});
  setTimeout(tickClock, 1000);
})();

// ─── TAB SWITCHING ───────────────────────────────────
document.querySelectorAll(".tab").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.querySelectorAll(".panel").forEach(p => p.classList.remove("active"));
    btn.classList.add("active");
    const id = btn.dataset.tab;
    document.getElementById("panel-" + id).classList.add("active");

    // Lazy-load on first switch
    if(id === "scan"  && !scanLoaded) fetchScan();
    if(id === "afd"   && !afdLoaded)  fetchAfd();
    if(id === "kalshi" && !kalshiLoaded) fetchKalshi();
  });
});

// ─── HELPERS ─────────────────────────────────────────
function minAgo(iso){
  if(!iso) return 999;
  return Math.round((Date.now() - new Date(iso).getTime())/60000);
}
function compassArrow(deg){
  if(deg === null || deg === undefined) return {style:""};
  return {style:`transform:rotate(${deg}deg)`};
}
function fmt(v, suffix=""){
  return v != null ? v + suffix : "—";
}

// ─── LIVE METAR CARD ─────────────────────────────────
function renderCard(id, d){
  const wt = d.wind_trend || {};
  const tg = d.tgroup    || {};
  const hasShift  = wt.shift_detected;
  const hasRegime = wt.regime_change;

  let cls = "card";
  if(hasRegime) cls += " ks-regime";
  else if(hasShift) cls += " ks-shift";

  let banner = "";
  if(hasRegime) banner = `<div class="ks-banner regime">⚡ regime change — verify kill-switch</div>`;
  else if(hasShift) banner = `<div class="ks-banner shift">⚠ wind shift ≥40° — monitor</div>`;

  let tgBadge = "";
  if(tg.temp_f != null){
    const stale = tg.time_utc ? minAgo(tg.time_utc) > 70 : true;
    tgBadge = `<span class="tg-badge${stale?" stale":""}" title="T-group @ ${tg.time_local||"?"}">` +
              `<span class="lbl">exact</span>${tg.temp_f}°F</span>`;
  }

  let rhCol = "var(--txt)";
  if(d.rh != null){
    if(d.rh < 20)  rhCol = "var(--green)";
    else if(d.rh > 70) rhCol = "var(--red)";
    else rhCol = "var(--amber)";
  }

  let dhi = "";
  if(d.daily_max_f != null){
    dhi = `<div class="divider"></div>
           <div class="dhi-row">
             <span class="dhi-l">Today Hi</span>
             <span><span class="dhi-v">${d.daily_max_f}°F</span><span class="dhi-t">${d.daily_max_time||""}</span></span>
           </div>`;
  }

  let upRow = "";
  if(d.upstream){
    const up = d.upstream;
    upRow = `<div class="upstream-row">
               <span class="up-l">↑ upstream ${up.station}</span>
               <span class="up-v">${up.sector} @ ${up.wind_mph} mph</span>
             </div>`;
  }

  const arrow = compassArrow(d.wind_dir);

  return `<div class="${cls}">
    ${banner}
    <div class="card-hdr">
      <div class="card-hdr-l">
        <span class="sid">${id}</span>
        <span class="city">${d.city}</span>
      </div>
      <span class="obs-time">${d.obs_time_local||"—"}</span>
    </div>
    <div class="card-body">
      <div class="temp-row">
        <div class="temp-big">${d.temp_f != null ? d.temp_f : "—"}<span class="u">°F</span></div>
        ${tgBadge}
      </div>
      <div class="stats">
        <div class="stat">
          <span class="stat-l">Wind</span>
          <span class="stat-v">
            <span class="wind-arrow" ${arrow.style ? `style="${arrow.style}"` : ""}>↑</span>
            ${d.wind_sector} @ ${d.wind_mph != null ? d.wind_mph : "—"} mph
          </span>
        </div>
        <div class="stat">
          <span class="stat-l">Dew</span>
          <span class="stat-v">${d.dew_f != null ? d.dew_f+"°F" : "—"}</span>
        </div>
        <div class="stat">
          <span class="stat-l">RH</span>
          <span class="stat-v" style="color:${rhCol}">${d.rh != null ? Math.round(d.rh)+"%" : "—"}</span>
        </div>
        <div class="stat">
          <span class="stat-l">Pressure</span>
          <span class="stat-v">${d.baro_mb != null ? d.baro_mb+" mb" : "—"}</span>
        </div>
      </div>
      <div class="stats" style="margin-top:5px">
        <div class="stat">
          <span class="stat-l">Sky</span>
          <span class="stat-v">${d.sky||"—"}</span>
        </div>
        <div class="stat">
          <span class="stat-l">Wind trend</span>
          <span class="stat-v" style="color:${hasRegime?"var(--red)":hasShift?"var(--amber)":"var(--txt-dim)"}">
            ${hasRegime ? "⚡ regime" : hasShift ? "⚠ shifting" : "steady"}
          </span>
        </div>
      </div>
      ${upRow}
      ${dhi}
    </div>
  </div>`;
}

// ─── LIVE METAR REFRESH ──────────────────────────────
async function refresh(){
  try {
    const r = await fetch("/api/snapshot");
    if(!r.ok) throw new Error("HTTP "+r.status);
    const data = await r.json();

    // First load: capture server-defined card order
    if(data.card_order && cardOrder.length === 0) cardOrder = data.card_order;

    const ld = document.getElementById("loader");
    if(ld) ld.style.display="none";

    document.getElementById("syncT").textContent =
      new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:true});

    // Render in CARD_ORDER
    let html = "";
    const order = cardOrder.length ? cardOrder : Object.keys(data.stations);
    for(const id of order){
      if(data.stations[id]) html += renderCard(id, data.stations[id]);
    }
    document.getElementById("grid").innerHTML = html;

  } catch(e){
    console.error(e);
    const ld = document.getElementById("loader");
    if(ld && ld.style.display !== "none"){
      document.getElementById("loader-msg").textContent = "Connection error — retrying…";
    }
  }
}
refresh();
setInterval(refresh, 30000);

// ─── MODEL SCAN ──────────────────────────────────────
let scanLoaded = false;
async function fetchScan(force=false){
  document.getElementById("scan-freshness").textContent = "Loading…";
  try {
    const url = force ? "/api/scan?_force=1" : "/api/scan";
    const r = await fetch(url);
    const data = await r.json();
    scanLoaded = true;

    const tbody = document.getElementById("scan-body");
    tbody.innerHTML = "";
    for(const row of (data.stations || [])){
      tbody.innerHTML += `<tr>
        <td>${row.city} <span style="color:var(--txt-dim);font-size:10px">${row.station}</span></td>
        <td>${fmt(row.nws,"°F")}</td>
        <td>${fmt(row.ecmwf,"°F")}</td>
        <td>${fmt(row.gfs,"°F")}</td>
        <td class="mean">${fmt(row.mean,"°F")}</td>
      </tr>`;
    }
    const el = document.getElementById("scan-freshness");
    el.className = data.cached ? "cached" : "fresh";
    el.textContent = (data.cached ? "Cached · " : "Fresh · ") + "Date: " + data.date;
  } catch(e){
    document.getElementById("scan-freshness").textContent = "Error: " + e.message;
  }
}
document.getElementById("scan-refresh-btn").addEventListener("click", () => fetchScan(true));

// ─── AFD ─────────────────────────────────────────────
let afdLoaded = false;
async function fetchAfd(force=false){
  document.getElementById("afd-freshness").textContent = "Loading…";
  try {
    const r = await fetch("/api/afd");
    const data = await r.json();
    afdLoaded = true;

    const grid = document.getElementById("afd-grid");
    grid.innerHTML = "";
    const order = cardOrder.length ? cardOrder : Object.keys(data.stations || {});
    for(const sid of order){
      const s = (data.stations || {})[sid];
      if(!s) continue;
      if(s.error){
        grid.innerHTML += `<div class="afd-card">
          <div class="afd-hdr"><span class="afd-sid">${sid}</span><span class="afd-wfo">${s.wfo}</span></div>
          <div class="afd-err">Error: ${s.error}</div>
        </div>`;
      } else {
        grid.innerHTML += `<div class="afd-card" id="afd-${sid}">
          <div class="afd-hdr" onclick="document.getElementById('afd-${sid}').classList.toggle('open')">
            <span class="afd-sid">${sid} <span style="color:var(--txt-dim);font-size:10px;font-weight:400">${s.wfo}</span></span>
            <span style="color:var(--txt-dim);font-size:10px">▼ expand</span>
          </div>
          <div class="afd-body">${(s.text||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</div>
        </div>`;
      }
    }
    const el = document.getElementById("afd-freshness");
    el.className = data.cached ? "cached" : "fresh";
    el.textContent = data.cached ? "Cached" : "Fresh";
  } catch(e){
    document.getElementById("afd-freshness").textContent = "Error: " + e.message;
  }
}
document.getElementById("afd-refresh-btn").addEventListener("click", () => fetchAfd(true));

// ─── KALSHI ──────────────────────────────────────────
let kalshiLoaded = false;
async function fetchKalshi(force=false){
  document.getElementById("kalshi-freshness").textContent = "Loading…";
  try {
    const r = await fetch("/api/kalshi");
    const data = await r.json();
    kalshiLoaded = true;

    const grid = document.getElementById("kalshi-grid");
    grid.innerHTML = "";
    const order = cardOrder.length ? cardOrder : Object.keys(data.cities || {});
    for(const sid of order){
      const c = (data.cities || {})[sid];
      if(!c) continue;
      let marketsHtml = "";
      if(c.markets && c.markets.length){
        for(const m of c.markets){
          marketsHtml += `<div class="kt-row">
            <span class="kt-title">${m.title || m.ticker}</span>
            <span class="kt-prices">
              <span><span class="kt-lbl">ASK </span><span class="kt-ask">${m.yes_ask != null ? m.yes_ask+"¢" : "—"}</span></span>
              <span><span class="kt-lbl">BID </span><span class="kt-bid">${m.yes_bid != null ? m.yes_bid+"¢" : "—"}</span></span>
            </span>
          </div>`;
        }
      } else {
        marketsHtml = `<div class="kt-none">Market not open yet for ${data.date}</div>`;
      }
      grid.innerHTML += `<div class="kalshi-city">
        <div class="kalshi-city-hdr">${c.city} <span class="kt">${c.event_ticker}</span></div>
        ${marketsHtml}
      </div>`;
    }
    const el = document.getElementById("kalshi-freshness");
    el.className = data.cached ? "cached" : "fresh";
    el.textContent = (data.cached ? "Cached · " : "Fresh · ") + "Date: " + data.date;
  } catch(e){
    document.getElementById("kalshi-freshness").textContent = "Error: " + e.message;
  }
}
document.getElementById("kalshi-refresh-btn").addEventListener("click", () => fetchKalshi(true));
</script>
</body>
</html>
